---
title: iHet predictions on tracerx data
params:
    cpus: 1
    meta: NULL
    mofa_models_zip: /data/projects/2021/nsclc_heterogeneity/from_oscar/MOFA_out.zip
    artifact_dir: "/home/sturm/Downloads/ihet"
---


# required data
zipMOFAmodels <- "data_iHet_predictions/MOFA_out.zip” # zip file containing the MOFA models
TCGAbootstrapFeatureStats <- "data_iHet_predictions/TCGA_bootstrap_features_stats.rds” # TCGA overall mean and standard deviation:
corFibAllTissues <- "data_iHet_predictions/correlation_features_fibroblasts_all_tissues.RDS” # - Easier features correlated with imaging features

# utils (function available in github: analyses/10_mofa/
source("./helper_iHet_predictions.R")

# RNA-seq
all_dataset <- list(counts = counts, tpm = tpm) 

# Compute iHet
iHet_df <- compute_iHet(
dataset = all_dataset, 
model = "NSCLC”, 
use_bootstrap_weights=TRUE, 
method = "iHet", 
scale_mofa_weights = TRUE
)

